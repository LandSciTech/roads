<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>roads Package • roads</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="roads Package">
<meta property="og:description" content="roads">
<meta property="og:image" content="https://landscitech.github.io/roads/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">roads</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/roads-vignette.html">roads Package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/LandSciTech/roads/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="roads-vignette_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>roads Package</h1>
            
            <h4 data-toc-skip class="date">2022-06-17</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/LandSciTech/roads/blob/HEAD/vignettes/roads-vignette.Rmd" class="external-link"><code>vignettes/roads-vignette.Rmd</code></a></small>
      <div class="hidden name"><code>roads-vignette.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette provides a tutorial on the use of the <code>roads</code> package for the spatial simulation of future roads development under a given resource development scenario. This tutorial, which borrows heavily from a demonstration written by Kyle Lochhead and Tyler Muhly in 2018, will focus primarily on the <code>projectRoads</code> function of the <code>roads</code> package, as it is responsible for performing the simulation. Example data sets used below are included in the package as <code>CLUSexample</code> and <code>demoScen</code>.</p>
<p>In the context of this package, resource development scenarios are represented by three components:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Cost Layer:</strong> a spatial, gridded cost layer covering the entire landscape, wherein each cell value represents the cost of new road development through it.</li>
<li>
<strong>Existing Road Network:</strong> a spatial, representation of the existing road network within the landscape.</li>
<li>
<strong>Landings:</strong> a set of locations where new resource development is to take place.</li>
</ol>
<p>Given an input resource development scenario, <code>projectRoads</code> will simulate new roads between the existing road network and the landings using one of three algorithms:</p>
<ol style="list-style-type: decimal">
<li><strong>Snapping</strong></li>
<li><strong>Least-cost path (LCP)</strong></li>
<li><strong>Minimum spanning tree (MST)</strong></li>
</ol>
<p>The output of <code>projectRoads</code> is a list of simulation results referred to as a “sim list”. The list contains five elements:</p>
<ol style="list-style-type: decimal">
<li>
<strong>roads:</strong> the projected road network, including new and input roads.</li>
<li>
<strong>costSurface:</strong> the input cost surface, this is <em>not</em> updated to reflect the new roads that were added.</li>
<li>
<strong>roadMethod</strong> the road simulation method used.</li>
<li>
<strong>landings</strong> the landings used in the simulation.</li>
<li>
<strong>g</strong> the graph that describes the cost of paths between each cell in the cost raster. This is updated based on the new roads so that vertices were connected by new roads now have a cost of 0. This can be used to avoid recomputing the graph in a simulation with multiple time steps.</li>
</ol>
<div class="section level4">
<h4 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h4>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/LandSciTech/roads" class="external-link">roads</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rspatial.org/raster" class="external-link">raster</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span>

<span class="co">## colours for displaying cost raster </span>
<span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"viridis"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="co"># Use colour blind friendly palette if available</span>
  <span class="va">rastColours</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'grey50'</span>, <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
  <span class="va">rastColours</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'grey50'</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">terrain.colors</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="resource-development-scenario">Resource development scenario<a class="anchor" aria-label="anchor" href="#resource-development-scenario"></a>
</h2>
<div class="section level4">
<h4 id="cost-layer">1. Cost layer<a class="anchor" aria-label="anchor" href="#cost-layer"></a>
</h4>
<p>The cost of new roads development within a landscape must be provided as a single, numeric <a href="https://www.rdocumentation.org/packages/raster/versions/2.9-5/topics/Raster-class" class="external-link"><code>RasterLayer</code></a> object. Each cell of this raster represents the cost of new road development (the definition of which is up to the user) through it. The total cost of the development of a new road segment is considered to be the sum of the cost raster cells that it traverses.</p>
<ul>
<li>The traversal cost of existing road segments is assumed to be zero. If existing roads are not 0 in the cost layer they can be “burned in” by setting <code>roadsInCost = FALSE</code>.</li>
<li>The extent of the landscape of interest is assumed to match the extent of the specified cost raster layer.</li>
<li>The coordinate reference system (CRS) of this raster must match all other input data-sets.<br>
</li>
<li>While the cell size (or resolution) of this cost raster is up the user, it is important to remember that a unit area of road is assumed to take up an entire cell.</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">costRaster</span> <span class="op">&lt;-</span> <span class="va">CLUSexample</span><span class="op">$</span><span class="va">cost</span></code></pre></div>
</div>
<div class="section level4">
<h4 id="existing-road-network-layer">2. Existing road network layer<a class="anchor" aria-label="anchor" href="#existing-road-network-layer"></a>
</h4>
<p>The state of the existing roads network must be specified to the <code>projectRoads</code> method. This specification is made in the form of a sf object with geometry type “LINES”, a SpatialLines object, or a RasterLayer.</p>
<p>The roads network included in the <code>CLUSexample</code> data-set is a raster but is converted to a line to make plotting easier.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## existing roads network raster from the CLUSexample data-set</span>
<span class="va">existingRoadsRast</span> <span class="op">&lt;-</span> <span class="fu">roads</span><span class="fu">::</span><span class="va"><a href="../reference/CLUSexample.html">CLUSexample</a></span><span class="op">$</span><span class="va">roads</span>

<span class="co"># Note rasterToLineSegments only works for simple road networks</span>
<span class="co"># roadsLine &lt;- roads::CLUSexample$roads %&gt;% rasterToLineSegments()</span>
<span class="co"># Road must not be flat b/c weird issue in sf package #1730</span>
<span class="va">roadsLine</span> <span class="op">&lt;-</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/sfc.html" class="external-link">st_sfc</a></span><span class="op">(</span>geometry <span class="op">=</span> <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st.html" class="external-link">st_linestring</a></span><span class="op">(</span>
  <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">4.5</span>, <span class="fl">4.5</span>, <span class="fl">4.51</span><span class="op">)</span>,
         ncol <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">T</span><span class="op">)</span> 
<span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span>
  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_as_sf.html" class="external-link">st_as_sf</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
</div>
<div class="section level3">
<h3 id="landings-layers">3. Landings layer(s)<a class="anchor" aria-label="anchor" href="#landings-layers"></a>
</h3>
<p>Landings, or resource development locations, that are to be connected to the existing road network can be specified to the <code>projectRoads</code> method in a variety of forms. These include specification as:</p>
<ul>
<li>A logical <code>RasterLayer</code> object with cell values of <code>TRUE</code> for landings,</li>
<li>A <code>SpatialPoints</code> or <code>SpatialPointsDataFrame</code> {<a href="https://CRAN.R-project.org/package=sp" class="external-link"><code>sp</code></a>} object with points representing landings,</li>
<li>A matrix with at least two columns, with columns 1 and 2 representing x any y coordinates of landing locations respectively,</li>
<li>A <code>SpatialPolygons</code>or <code>SpatialPolygonsDataFrame</code> {<a href="https://CRAN.R-project.org/package=sp" class="external-link"><code>sp</code></a>} object with polygons representing landings,</li>
<li>A sf {<a href="https://r-spatial.github.io/sf/" class="external-link"><code>sf</code></a>} object with geometry type “POINTS” or “POLYGONs”</li>
</ul>
<p>If the landings are polygons then the centroid is used as the destination for new roads. For more control or to have more than one landing per polygon see Multiple landings per harvest block below.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## landings as spatial points</span>
<span class="va">landings</span> <span class="op">&lt;-</span> <span class="fu">roads</span><span class="fu">::</span><span class="va"><a href="../reference/CLUSexample.html">CLUSexample</a></span><span class="op">$</span><span class="va">landings</span>

<span class="co">## plot example scenario</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">costRaster</span>, col <span class="op">=</span> <span class="va">rastColours</span>, main <span class="op">=</span> <span class="st">'Example Scenario'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">roadsLine</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">landings</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">5.6</span>,y<span class="op">=</span><span class="fl">4.5</span>,pch<span class="op">=</span><span class="fl">19</span>,xpd<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/text.html" class="external-link">text</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">5.8</span>,y<span class="op">=</span><span class="fl">4.5</span>,labels<span class="op">=</span><span class="st">'landing'</span>,adj<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.4</span><span class="op">)</span>,xpd<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.3</span>,<span class="fl">5.6</span><span class="op">)</span>,y<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.2</span>,<span class="fl">4.2</span><span class="op">)</span>,lwd<span class="op">=</span><span class="fl">2</span>,xpd<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/text.html" class="external-link">text</a></span><span class="op">(</span>x<span class="op">=</span><span class="fl">5.75</span>,y<span class="op">=</span><span class="fl">4.2</span>,labels<span class="op">=</span><span class="st">'roads'</span>,adj<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0.3</span><span class="op">)</span>,xpd<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="roads-vignette_files/figure-html/unnamed-chunk-3-1.png" width="480"></p>
<p>Notice that the top row of the raster has a cost of zero. This row is where, in this scenario, an existing road traverses the landscape.</p>
</div>
</div>
<div class="section level2">
<h2 id="simulation-of-new-roads-development">Simulation of new roads development<a class="anchor" aria-label="anchor" href="#simulation-of-new-roads-development"></a>
</h2>
<div class="section level3">
<h3 id="simulation-methods">Simulation methods<a class="anchor" aria-label="anchor" href="#simulation-methods"></a>
</h3>
<div class="section level4">
<h4 id="snapping">1. Snapping<a class="anchor" aria-label="anchor" href="#snapping"></a>
</h4>
<p>This approach simply ‘snaps’ a landing to the nearest existing road segment. Since the snapping is done for each landing it is also called an independent path method.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## project new roads using the 'snap' approach</span>
<span class="va">projRoads_snap</span> <span class="op">&lt;-</span> <span class="fu">roads</span><span class="fu">::</span><span class="fu"><a href="../reference/projectRoads.html">projectRoads</a></span><span class="op">(</span><span class="va">landings</span>, <span class="va">costRaster</span>, <span class="va">roadsLine</span>,
                                      roadMethod <span class="op">=</span> <span class="st">'snap'</span><span class="op">)</span>
<span class="co">#&gt; 0s detected in cost raster, these will be considered as existing roads</span>

<span class="co">## plot the cost raster, landings, and roads segments to the landings</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">costRaster</span>, col <span class="op">=</span> <span class="va">rastColours</span>, main <span class="op">=</span> <span class="st">"'Snapped' roads"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">landings</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span>  
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">projRoads_snap</span><span class="op">$</span><span class="va">roads</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> 

<span class="co">## update legend</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">5.5</span>, y <span class="op">=</span> <span class="fl">4.8</span>, pch <span class="op">=</span> <span class="fl">19</span>, xpd <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/text.html" class="external-link">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">5.7</span>, y <span class="op">=</span> <span class="fl">4.8</span>, labels <span class="op">=</span> <span class="st">'landing'</span>, adj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.4</span><span class="op">)</span>, xpd <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.3</span>, <span class="fl">5.6</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.2</span>, <span class="fl">4.2</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>, xpd <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/text.html" class="external-link">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">5.75</span>, y <span class="op">=</span> <span class="fl">4.2</span>, labels <span class="op">=</span> <span class="st">'roads'</span>, adj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.3</span><span class="op">)</span>, xpd <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="roads-vignette_files/figure-html/unnamed-chunk-4-1.png" width="480"></p>
<p>Using this approach, a few issues would arise:</p>
<ol style="list-style-type: decimal">
<li><p>parallel roads are not realistic since there is no branching and this leads to increased numbers of roads;</p></li>
<li><p>costs are not included (i.e., slope and barriers like large water bodies).</p></li>
</ol>
<p>This means this approach, while simple to implement, would over estimate the amount of simulated roads.</p>
</div>
<div class="section level4">
<h4 id="least-cost-paths-lcp">2. Least Cost Paths (LCP)<a class="anchor" aria-label="anchor" href="#least-cost-paths-lcp"></a>
</h4>
<p>This approach builds upon the snapping approach by assuming a ‘cost directed’ path (i.e., “as the wolf runs”) for each landing to the existing road network. This approach requires that a cost surface be provided and used to build a mathematical <a href="https://en.wikipedia.org/wiki/Graph_theory" class="external-link">graph</a> using <a href="https://igraph.org/r/" class="external-link"><code>igraph</code></a> and takes considerably longer to compute.</p>
<p>Once the graph is built, the least cost path between any two vertices is determined using <a href="https://en.wikipedia.org/wiki/Dijkstra%27s_algorithm" class="external-link">Dijkstra’s algorithm</a>, which is implemented in the <a href="https://igraph.org/r/doc/distances.html" class="external-link">shortest_paths</a> function in <code>igraph</code>. The graph can be easily updated to simulate the change in the cost surface from dynamically developing roads during the simulation. Note, that this dynamic behaviour would not be possible in a pre-solve of the road network. To implement a pre-solve approach the <code>igraph</code> function <a href="https://igraph.org/r/doc/distances.html" class="external-link">all_shortest_paths</a> can be used to calculate all shortest paths between pairs of vertices; however, this is not included here.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## project new roads using the 'LCP' approach</span>
<span class="va">projRoads_lcp</span> <span class="op">&lt;-</span> <span class="fu">roads</span><span class="fu">::</span><span class="fu"><a href="../reference/projectRoads.html">projectRoads</a></span><span class="op">(</span><span class="va">landings</span>, 
                                        <span class="va">costRaster</span>, 
                                        <span class="va">roadsLine</span>, 
                                        roadMethod <span class="op">=</span> <span class="st">'lcp'</span><span class="op">)</span>
<span class="co">#&gt; 0s detected in cost raster, these will be considered as existing roads</span>

<span class="co">## plot the cost raster and overlay it with new roads</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">costRaster</span>, col <span class="op">=</span> <span class="va">rastColours</span>, main <span class="op">=</span> <span class="st">"'LCP' roads"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">projRoads_lcp</span><span class="op">$</span><span class="va">roads</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">landings</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span>  <span class="co">## landings points</span>
<span class="co">## legend</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">5.5</span>, y <span class="op">=</span> <span class="fl">4.8</span>, pch <span class="op">=</span> <span class="fl">19</span>, xpd <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/text.html" class="external-link">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">5.7</span>, y <span class="op">=</span> <span class="fl">4.8</span>, labels <span class="op">=</span> <span class="st">'landing'</span>, adj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.4</span><span class="op">)</span>, xpd <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.3</span>, <span class="fl">5.6</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.2</span>, <span class="fl">4.2</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>, xpd <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/text.html" class="external-link">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">5.75</span>, y <span class="op">=</span> <span class="fl">4.2</span>, labels <span class="op">=</span> <span class="st">'roads'</span>, adj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.3</span><span class="op">)</span>, xpd <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="roads-vignette_files/figure-html/unnamed-chunk-5-1.png" width="480"></p>
<p>The main disadvantage of this approach is that roads are developed independently. The least cost path may produce parallel or redundant roads since a path is made for each target to the corresponding closest point. This may mimic road development since road tenures give licensees the right to limit other industrial users from using their road (i.e., gated roads); thereby forcing the other industrial user to consider building a nearly parallel road. In some cases there will be branching, where two roads connecting two landings to an existing road network will use the same least cost path; however, this will be conditional on the spatial configuration of the local cost surface and the existing road network. Thus, the amount of road being developed from the LCP is dependent on the local cost surface and may be either higher or lower than the corresponding snap approach.</p>
</div>
<div class="section level4">
<h4 id="minimum-spanning-tree-mst-with-least-cost-paths-lcp">3. Minimum Spanning Tree (MST) with Least Cost Paths (LCP)<a class="anchor" aria-label="anchor" href="#minimum-spanning-tree-mst-with-least-cost-paths-lcp"></a>
</h4>
<p>The MST approach builds upon the LCP approach by determining if landings should be connected to one another before being connected to the existing road network. In the MST approach, LCPs are estimated both between the landings and between landings and the existing road network. These distances are then used as nodes for solving a minimum spanning tree. The sequence of vertices from the LCPs are then constructed following the solution to the MST.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## project new roads using the 'MST' approach</span>
<span class="va">projRoads_mst</span> <span class="op">&lt;-</span> <span class="fu">roads</span><span class="fu">::</span><span class="fu"><a href="../reference/projectRoads.html">projectRoads</a></span><span class="op">(</span><span class="va">landings</span>, 
                                        <span class="va">costRaster</span>,
                                        <span class="va">roadsLine</span>, 
                                        roadMethod <span class="op">=</span> <span class="st">'mst'</span><span class="op">)</span>
<span class="co">#&gt; 0s detected in cost raster, these will be considered as existing roads</span>

<span class="co">## plot the cost raster and overlay it with new roads</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">costRaster</span>, col <span class="op">=</span> <span class="va">rastColours</span>, main <span class="op">=</span> <span class="st">"'MST' roads"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">projRoads_mst</span><span class="op">$</span><span class="va">roads</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">landings</span>, pch <span class="op">=</span> <span class="fl">19</span>, col <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span>  <span class="co">## landings points</span>
<span class="co">## legend</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">5.5</span>, y <span class="op">=</span> <span class="fl">4.8</span>, pch <span class="op">=</span> <span class="fl">19</span>, xpd <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="st">'red'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/text.html" class="external-link">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">5.7</span>, y <span class="op">=</span> <span class="fl">4.8</span>, labels <span class="op">=</span> <span class="st">'landing'</span>, adj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.4</span><span class="op">)</span>, xpd <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5.3</span>, <span class="fl">5.6</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.2</span>, <span class="fl">4.2</span><span class="op">)</span>, lwd <span class="op">=</span> <span class="fl">2</span>, xpd <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/text.html" class="external-link">text</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">5.75</span>, y <span class="op">=</span> <span class="fl">4.2</span>, labels <span class="op">=</span> <span class="st">'roads'</span>, adj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0.3</span><span class="op">)</span>, xpd <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="roads-vignette_files/figure-html/unnamed-chunk-6-1.png" width="480"></p>
<p>The MST approach will produce the least amount of roads (relative to the other approaches), given targets are allowed to connect to other target locations. This approach simulates a realistic view of road branching relative to the other two approaches. However, given the need to get LCP distances, solve a MST and then construct the LCPs, it will likely be the most costly in terms of computation time.</p>
</div>
</div>
<div class="section level3">
<h3 id="one-time-versus-multi-temporal-simulation">One-time versus multi-temporal simulation<a class="anchor" aria-label="anchor" href="#one-time-versus-multi-temporal-simulation"></a>
</h3>
<p>Roads development simulation can be performed either for a single time step (one-time) or for multiple time steps. This section will use a demonstration scenario <code>demoScen</code> data-set that is included with the roads package. There are four different sets of landings.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## colours for displaying cost raster</span>
<span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"viridis"</span>, quietly <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="co"># Use colour blind friendly palette if available</span>
  <span class="va">rastColours2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'grey50'</span>, <span class="fu">viridis</span><span class="fu">::</span><span class="fu"><a href="https://sjmgarnier.github.io/viridisLite/reference/viridis.html" class="external-link">viridis</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span> <span class="kw">else</span> <span class="op">{</span>
  <span class="va">rastColours2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'grey50'</span>, <span class="fu"><a href="https://rdrr.io/r/grDevices/palettes.html" class="external-link">terrain.colors</a></span><span class="op">(</span><span class="fl">30</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="co">## scenario </span>
<span class="va">scen</span> <span class="op">&lt;-</span> <span class="va">demoScen</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="co">## landing sets 1 to 4 of this scenario </span>
<span class="va">land.pnts</span> <span class="op">&lt;-</span> <span class="va">scen</span><span class="op">$</span><span class="va">landings.points</span><span class="op">[</span><span class="va">scen</span><span class="op">$</span><span class="va">landings.points</span><span class="op">$</span><span class="va">set</span><span class="op"><a href="https://rdrr.io/pkg/raster/man/match.html" class="external-link">%in%</a></span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span>,<span class="op">]</span>
<span class="co">## plot the cost raster and landings</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">'mar'</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">scen</span><span class="op">$</span><span class="va">cost.rast</span>, col <span class="op">=</span> <span class="va">rastColours2</span>, main <span class="op">=</span> <span class="st">'Cost and landings (by set)'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">land.pnts</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, pch <span class="op">=</span> <span class="fl">21</span>, cex <span class="op">=</span> <span class="fl">2</span>, bg <span class="op">=</span> <span class="st">'white'</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/text.html" class="external-link">text</a></span><span class="op">(</span><span class="va">land.pnts</span><span class="op">@</span><span class="va">coords</span>, labels <span class="op">=</span> <span class="va">land.pnts</span><span class="op">$</span><span class="va">set</span>, cex <span class="op">=</span> <span class="fl">0.6</span>, adj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.3</span><span class="op">)</span>,
     xpd <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="roads-vignette_files/figure-html/unnamed-chunk-7-1.png" width="672"></p>
<div class="section level4">
<h4 id="one-time-simulation">One-time simulation<a class="anchor" aria-label="anchor" href="#one-time-simulation"></a>
</h4>
<p>If landings, costs, and roads are all specified to <code>projectRoads</code>, then a one-time road simulation will be performed that returns a list object holding the projected roads and related information. This can be repeated multiple times for different road building scenarios but each simulation will be independent of previous simulations. This would be appropriate if each landing set represented alternate scenarios for development.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## project roads for landing sets 1 to 4, with independent one-time simulations</span>
<span class="va">oneTime_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span> <span class="co">## empty list </span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">{</span>
  <span class="va">oneTime_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">oneTime_sim</span>,
                       <span class="fu">roads</span><span class="fu">::</span><span class="fu"><a href="../reference/projectRoads.html">projectRoads</a></span><span class="op">(</span><span class="va">land.pnts</span><span class="op">[</span><span class="va">land.pnts</span><span class="op">$</span><span class="va">set</span><span class="op">==</span><span class="va">i</span>,<span class="op">]</span>,
                                              <span class="va">scen</span><span class="op">$</span><span class="va">cost.rast</span>,
                                              <span class="va">scen</span><span class="op">$</span><span class="va">cost.rast</span><span class="op">==</span><span class="fl">0</span>,
                                              roadMethod<span class="op">=</span><span class="st">'mst'</span><span class="op">)</span><span class="op">$</span><span class="va">roads</span><span class="op">)</span>
<span class="op">}</span>
<span class="co">#&gt; 0s detected in cost raster, these will be considered as existing roads</span>
<span class="co">#&gt; 0s detected in cost raster, these will be considered as existing roads</span>
<span class="co">#&gt; 0s detected in cost raster, these will be considered as existing roads</span>
<span class="co">#&gt; 0s detected in cost raster, these will be considered as existing roads</span>

<span class="co">## plot</span>
<span class="va">oldpar</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>, mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">'mar'</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">{</span>
  <span class="va">oneTime_sim</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">[</span><span class="op">!</span><span class="va">oneTime_sim</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span> 
  <span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">scen</span><span class="op">$</span><span class="va">cost.rast</span>, col <span class="op">=</span> <span class="va">rastColours2</span>, 
       main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Landings set '</span>, <span class="va">i</span><span class="op">)</span>,
       legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">oneTime_sim</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="st">"grey50"</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">land.pnts</span><span class="op">[</span><span class="va">land.pnts</span><span class="op">$</span><span class="va">set</span> <span class="op">==</span> <span class="va">i</span>, <span class="op">]</span>, add <span class="op">=</span> <span class="cn">TRUE</span>,
       pch <span class="op">=</span> <span class="fl">21</span>, cex <span class="op">=</span> <span class="fl">1.5</span>, bg <span class="op">=</span> <span class="st">'white'</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><img src="roads-vignette_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<p>While the results of these one-time simulations may be fine when looking at each landings scenario/set independently (e.g. each representing a possible scenario for time t=1), they are likely not appropriate for cases where all landings sets follow a temporal development sequence (e.g. set 1 is development at time t=1, set 2 is development at time t=2, and so on). Independent one-time simulations do not take into account the fact that, for a given time step, existing roads for a given simulation should be the union of existing roads at time t=0 and all roads simulation results leading up to the current step. For example, existing roads input into simulation at time t=2 (landings set 2), would be the union of existing roads at time t=0 and projected roads at time t=1 (landings set 1).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## raster representing the union of completely independent simulations for multiple sets</span>
<span class="va">oneTime_sim</span> <span class="op">&lt;-</span> <span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/stack.html" class="external-link">stack</a></span><span class="op">(</span><span class="va">oneTime_sim</span><span class="op">)</span>
<span class="va">independent</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="va">oneTime_sim</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span>
<span class="co">## set non-road to NA for display purposes</span>
<span class="va">independent</span><span class="op">[</span><span class="op">!</span><span class="va">independent</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="cn">NA</span> 

<span class="co">## plot </span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">scen</span><span class="op">$</span><span class="va">cost.rast</span>, col <span class="op">=</span> <span class="va">rastColours2</span>,
     main <span class="op">=</span> <span class="st">'Union of independent sim results'</span>,
     legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">independent</span>, col <span class="op">=</span> <span class="st">'grey30'</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">land.pnts</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, pch <span class="op">=</span> <span class="fl">21</span>, cex <span class="op">=</span> <span class="fl">1.5</span>, bg <span class="op">=</span> <span class="st">'white'</span><span class="op">)</span></code></pre></div>
<p><img src="roads-vignette_files/figure-html/unnamed-chunk-9-1.png" width="480"></p>
</div>
<div class="section level4">
<h4 id="multi-temporal-simulation">Multi-temporal simulation<a class="anchor" aria-label="anchor" href="#multi-temporal-simulation"></a>
</h4>
<p>Multi-temporal (multiple time steps) roads projections can be performed by <code>projectRoads</code>, by providing the list produced by a previous simulation run (sim list) to the <code>sim</code> argument and the landings for the current time period. The function uses the sim list as a starting point and does not need to recompute the graph used to determine the least cost path. This can be implemented in a loop.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## continuing on with demo scenario 1</span>
<span class="co">## landing sets 1 to 4 of this scenario as a raster stack</span>
<span class="va">land.stack</span> <span class="op">&lt;-</span> <span class="va">scen</span><span class="op">$</span><span class="va">landings.stack</span><span class="op">[[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span>

<span class="co"># initialize sim list with first landings set</span>
<span class="va">multiTime_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/projectRoads.html">projectRoads</a></span><span class="op">(</span><span class="va">land.stack</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">scen</span><span class="op">$</span><span class="va">cost.rast</span>, 
                                               <span class="va">scen</span><span class="op">$</span><span class="va">road.line</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; 0s detected in cost raster, these will be considered as existing roads</span>

<span class="co"># iterate over landings sets using the sim list from the previous run as input</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/nlayers.html" class="external-link">nlayers</a></span><span class="op">(</span><span class="va">land.stack</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span>
  <span class="va">multiTime_sim</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>
    <span class="va">multiTime_sim</span>,
    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="../reference/projectRoads.html">projectRoads</a></span><span class="op">(</span>sim <span class="op">=</span>  <span class="va">multiTime_sim</span><span class="op">[[</span><span class="va">i</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, landings <span class="op">=</span> <span class="va">land.stack</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span>
  <span class="op">)</span> 
<span class="op">}</span>
<span class="co">#&gt; 0s detected in cost raster, these will be considered as existing roads</span>
<span class="co">#&gt; Burning in roads to cost raster from sf</span>
<span class="co">#&gt; 0s detected in cost raster, these will be considered as existing roads</span>
<span class="co">#&gt; Burning in roads to cost raster from sf</span>
<span class="co">#&gt; 0s detected in cost raster, these will be considered as existing roads</span>
<span class="co">#&gt; Burning in roads to cost raster from sf</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="st">'mar'</span><span class="op">)</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">scen</span><span class="op">$</span><span class="va">cost.rast</span>, col <span class="op">=</span> <span class="va">rastColours2</span>, main <span class="op">=</span> <span class="st">'Roads at time t = 0'</span>, 
       legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">scen</span><span class="op">$</span><span class="va">road.line</span>, col <span class="op">=</span> <span class="st">'grey30'</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
  
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">multiTime_sim</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">multiTime_sim</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">costSurface</span>, col <span class="op">=</span> <span class="va">rastColours2</span>, 
       main <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">'Roads at time t = '</span>, <span class="va">i</span><span class="op">)</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">multiTime_sim</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">roads</span>, col <span class="op">=</span> <span class="st">'grey30'</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">land.pnts</span><span class="op">[</span><span class="va">land.pnts</span><span class="op">$</span><span class="va">set</span> <span class="op">==</span> <span class="va">i</span>, <span class="op">]</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, pch <span class="op">=</span> <span class="fl">21</span>, 
         cex <span class="op">=</span> <span class="fl">1.5</span>, bg <span class="op">=</span> <span class="st">'white'</span><span class="op">)</span>
  <span class="kw">if</span> <span class="op">(</span><span class="va">i</span> <span class="op">&gt;=</span> <span class="fl">2</span><span class="op">)</span><span class="op">{</span>
    <span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">land.pnts</span><span class="op">[</span><span class="va">land.pnts</span><span class="op">$</span><span class="va">set</span> <span class="op">&lt;</span> <span class="va">i</span>, <span class="op">]</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, pch <span class="op">=</span> <span class="fl">1</span>, cex <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span>
    <span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">land.pnts</span><span class="op">[</span><span class="va">land.pnts</span><span class="op">$</span><span class="va">set</span> <span class="op">==</span> <span class="va">i</span>, <span class="op">]</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, pch <span class="op">=</span> <span class="fl">21</span>, 
         cex <span class="op">=</span> <span class="fl">1.5</span>, bg <span class="op">=</span> <span class="st">'white'</span><span class="op">)</span>
  <span class="op">}</span>
<span class="op">}</span></code></pre></div>
<p><img src="roads-vignette_files/figure-html/unnamed-chunk-10-1.png" width="672"></p>
</div>
</div>
<div class="section level3">
<h3 id="multiple-landings-per-harvest-block">Multiple landings per harvest block<a class="anchor" aria-label="anchor" href="#multiple-landings-per-harvest-block"></a>
</h3>
<p>Often harvest information is available as polygons showing the cutover area but the point locations of landings are not known. The roads package includes the <code>getLandingsFromTarget</code> function to address these situations. By default <code>getLandingsFromTarget</code> will use the centroid of a polygon as the landing but you can also specify a <code>sampleType</code> of “random” or “regular” and a <code>landingDens</code> in landings per unit area to generate multiple landing points with in the harvest block.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">harvPoly</span> <span class="op">&lt;-</span> <span class="va">demoScen</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">$</span><span class="va">landings.poly</span>

<span class="va">outCent</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getLandingsFromTarget.html">getLandingsFromTarget</a></span><span class="op">(</span><span class="va">harvPoly</span><span class="op">)</span>
<span class="fu">raster</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">harvPoly</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">outCent</span>, col <span class="op">=</span> <span class="st">"red"</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="roads-vignette_files/figure-html/unnamed-chunk-11-1.png" width="576"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># Get random sample with density 0.02 pts per unit area</span>
<span class="va">outRand</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getLandingsFromTarget.html">getLandingsFromTarget</a></span><span class="op">(</span><span class="va">harvPoly</span>, <span class="fl">0.02</span>, sampleType <span class="op">=</span> <span class="st">"random"</span><span class="op">)</span>
<span class="va">prRand</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/projectRoads.html">projectRoads</a></span><span class="op">(</span><span class="va">outRand</span>, <span class="va">scen</span><span class="op">$</span><span class="va">cost.rast</span>, <span class="va">scen</span><span class="op">$</span><span class="va">road.line</span><span class="op">)</span>
<span class="co">#&gt; 0s detected in cost raster, these will be considered as existing roads</span>

<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">scen</span><span class="op">$</span><span class="va">cost.rast</span>, main <span class="op">=</span> <span class="st">"Random Landings in Harvest Blocks"</span>,
     col <span class="op">=</span> <span class="va">rastColours2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">harvPoly</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">prRand</span><span class="op">$</span><span class="va">roads</span>, add <span class="op">=</span> <span class="cn">TRUE</span>,  col <span class="op">=</span> <span class="st">"grey50"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">outRand</span>, col <span class="op">=</span> <span class="st">"red"</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="roads-vignette_files/figure-html/unnamed-chunk-11-2.png" width="576"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># Get regular sample with density 0.02 pts per unit area</span>
<span class="va">outReg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/getLandingsFromTarget.html">getLandingsFromTarget</a></span><span class="op">(</span><span class="va">harvPoly</span>, <span class="fl">0.02</span>, sampleType <span class="op">=</span> <span class="st">"regular"</span><span class="op">)</span>
<span class="va">prReg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/projectRoads.html">projectRoads</a></span><span class="op">(</span><span class="va">outReg</span>, <span class="va">scen</span><span class="op">$</span><span class="va">cost.rast</span>,<span class="va">scen</span><span class="op">$</span><span class="va">road.line</span><span class="op">)</span>
<span class="co">#&gt; 0s detected in cost raster, these will be considered as existing roads</span>
<span class="co">#&gt; Warning: attribute variables are assumed to be spatially constant throughout all</span>
<span class="co">#&gt; geometries</span>


<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">scen</span><span class="op">$</span><span class="va">cost.rast</span>, main <span class="op">=</span> <span class="st">"Regular Landings in Harvest Blocks"</span>,
     col <span class="op">=</span> <span class="va">rastColours2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">harvPoly</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">prReg</span><span class="op">$</span><span class="va">roads</span>, add <span class="op">=</span> <span class="cn">TRUE</span>, col <span class="op">=</span> <span class="st">"grey50"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/raster/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">outReg</span>, col <span class="op">=</span> <span class="st">"red"</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></code></pre></div>
<p><img src="roads-vignette_files/figure-html/unnamed-chunk-11-3.png" width="576"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R">

<span class="co"># clean up </span>
<span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span><span class="va">oldpar</span><span class="op">)</span></code></pre></div>
<p>The regular sampling method may be the most realistic since it ensures that landings are spaced apart from each other.</p>
</div>
</div>
<div class="section level2">
<h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a>
</h2>
<p>This vignette is partially copied from Kyle Lochhead &amp; Tyler Muhly’s <a href="https://github.com/bcgov/clus/blob/master/reports/roads/draft-CLUS-roads.md" class="external-link">2018 CLUS example</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Sarah Endicott, Kyle Lochhead, Josie Hughes, Patrick Kirby.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.4.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
